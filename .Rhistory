library(igraph)
library(tidyverse)
library(Matrix)
# Reading in the files
actors <- read_csv("~/MATHCOMP479/tr1/movienetwork/vertex-actor.csv")
crew <- read_csv("~/MATHCOMP479/tr1/movienetwork/vertex-crew.csv")
movies <- read_csv("~/MATHCOMP479/tr1/movienetwork/vertex-movies.csv")
cast_edges <- read_csv("~/MATHCOMP479/tr1/movienetwork/edge-cast.csv")
# processing  to include only the last 10 years
movies <- movies %>% filter(Year >= 2014)
cast_edges <- cast_edges %>% filter(Year >= 2014)
# creating links between actors
actor_adj_mat <- sMatrix()
# creating links between actors
actor_adj_mat <- spMatrix(length(actors[[1]]),length(actors[[1]]))
unique(cast_edges$Source)
cast_edges %>% filter(Source=="movie"m2") %>% select(Target)
cast_edges %>% filter(Source=="m2") %>% select(Target)
cast_edges %>% filter(Source=="m262311") %>% select(Target)
(cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
rownames(actor_adj_mat) <- actors$Id
colnames(actor_adj_mat) <- actors$Id
actors_in_movie <- (cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
for (actor_pair in combn(actor_in_movie,2)){
actor_adj_mat[actor_pair[1],actor_pair[2]] <- actor_adj_mat[actor_pair[1],actor_pair[2]] + 1
}
actors_in_movie <- (cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
for (actor_pair in combn(actors_in_movie,2)){
actor_adj_mat[actor_pair[1],actor_pair[2]] <- actor_adj_mat[actor_pair[1],actor_pair[2]] + 1
}
actors_in_movie <- (cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
for (actor_pair in combn(actors_in_movie,2)){
print(actor_pair)
}
combn(actors_in_movie,2)
actr_pairs <- combn(actors_in_movie,2)
length(actr_pairs[1])
length(actr_pairs[[1]])
length(actr_pairs)
length(actr_pairs[1,])
actors_in_movie <- (cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in length(actor_pairs[1,])){
actor_adj_mat[actor_pair[i,1],actor_pair[i,2]] <- actor_adj_mat[actor_pair[i,1],actor_pair[i,2]] + 1
}
actors_in_movie <- (cast_edges %>% filter(Source=="m262311") %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[i,1],actor_pair[i,2]] <- actor_adj_mat[actor_pair[i,1],actor_pair[i,2]] + 1
}
1:length(actr_pairs[1,])
actr_pairs[1,1]
actr_pairs[1,2]
actr_pairs[2,1]
actr_pairs[2,2]
actr_pairs
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
rlang::last_trace()
actor_adj_mat
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
print(length(actor_pairs[1,]))
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
actors_in_movie <- (cast_edges %>% filter(Source==cast_edges$Source[1]) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
print(length(actor_pairs[1,]))
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
actors_in_movie <- (cast_edges %>% filter(Source==cast_edges$Source[89]) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
print(length(actor_pairs[1,]))
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
print(actor_pairs)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
head(actors_in_movie)
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
print(head(actors_in_movie))
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
print(head(actors_in_movie))
actor_pairs <- combn(actors_in_movie,2)
print(head(actor_pairs))
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] <- actor_adj_mat[actor_pair[1,i],actor_pair[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
}
17%%10
for (movie in unique(cast_edges$Source)){
t = 1
if (t%%100 = 0){
for (movie in unique(cast_edges$Source)){
t = 1
if (t%%100 == 0){
print(paste(t, " movies considered"))
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
}
for (movie in unique(cast_edges$Source)){
t = 1
if (t%%100 == 0){
print(paste(t, " movies considered"))
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
t <- t+1
}
for (movie in unique(cast_edges$Source)){
if (t%%100 == 0){
print(paste(t, " movies considered"))
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
t <- t+1
}
for (movie in unique(cast_edges$Source)){
if (t%%1 == 0){
print(paste(t, " movies considered"))
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
t <- t+1
}
t = 1
for (movie in unique(cast_edges$Source)){
if (t%%1 == 0){
print(paste(t, " movies considered"))
}
actors_in_movie <- (cast_edges %>% filter(Source==movie) %>% select(Target))[[1]]
actor_pairs <- combn(actors_in_movie,2)
for (i in 1:length(actor_pairs[1,])){
actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] <- actor_adj_mat[actor_pairs[1,i],actor_pairs[2,i]] + 1
}
t <- t+1
}
unique(cast_edges$Source)[6]
cast_edges%>% filter(Source=="m43074") %>% select(Target)
cast_edges%>% filter(Source=="m43074")
